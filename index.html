<!doctype html>
item.innerHTML = `<div style="max-width:220px"><strong>${act.title}</strong><div style="color:var(--muted); font-size:13px">${act.description}</div></div>
<div style="display:flex; gap:8px; align-items:center">
<div style="text-align:right"><div style="font-weight:700">Custo ${act.cost}</div><div style="color:var(--muted); font-size:12px">Redução ${act.effect}°C</div></div>
<button aria-pressed="false" data-id="${act.id}">Selecionar</button>
</div>`;
const btn = item.querySelector('button');
btn.addEventListener('click', ()=> toggleAction(act.id));
if(selectedActions.has(act.id)) btn.textContent = 'Selecionado';
actionsList.appendChild(item);
});
}


function toggleAction(id){
if(selectedActions.has(id)){
selectedActions.delete(id);
} else {
const act = actionsCatalog.find(a=>a.id===id);
if(points < act.cost){
alert('Você não tem pontos suficientes para selecionar esta ação.');
return;
}
selectedActions.add(id);
}
renderActions();
}


function applySelected(){
if(selectedActions.size === 0){ alert('Selecione pelo menos uma ação para aplicar.'); return; }
// calcula custo e efeito
let totalCost = 0; let totalEffect = 0;
selectedActions.forEach(id=>{
const a = actionsCatalog.find(x=>x.id===id);
totalCost += a.cost; totalEffect += a.effect;
});
if(points < totalCost){ alert('Pontos insuficientes para aplicar todas as ações selecionadas.'); return; }
// aplica
setPoints(points - totalCost);
// redução de temperatura simples: subtrai efeito, mas limitamos a -0.5 por rodada
temp = +(temp + totalEffect).toFixed(2);
if(temp < 0) temp = 0;
updateTherm();
// pontua jogador por aplicar ações
setScore(score + Math.floor(totalCost*1.5));
// limpa seleção
selectedActions.clear();
renderActions();
alert('Ações aplicadas! Observe o termômetro. Discuta em sala: quais efeitos reais poderiam demorar anos para aparecer?');
}


// --- UI screens ---
function showScreen(name){
intro.style.display = name==='intro' ? 'flex' : 'none';
quiz.style.display = name==='quiz' ? 'block' : 'none';
choicesPanel.style.display = name==='choices' ? 'block' : 'none';
}


// --- Eventos ---
startBtn.addEventListener('click', ()=>{ showScreen('quiz'); renderQuestion(0); });
playQuiz.addEventListener('click', ()=>{ startBtn.click(); });
nextQ.addEventListener('click', ()=> nextQuestion());
skipQ.addEventListener('click', ()=> { currentQ++; if(currentQ >= quizData.length) showScreen('choices'); else renderQuestion(currentQ); });
resetBtn.addEventListener('click', ()=> resetGame());
applyAll.addEventListener('click', ()=> applySelected());


// Inicialização
resetGame();
renderActions();
updateTherm();


// Acessibilidade: permitir teclado para opções com Enter
qOptions.addEventListener('keydown', (e)=>{
if(e.key === 'Enter' && e.target.classList.contains('option')){
e.target.click();
}
});


</script>
</body>
</html>
